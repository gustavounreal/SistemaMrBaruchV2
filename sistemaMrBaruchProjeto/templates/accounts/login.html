{% load static %}
{% block content %}
{% block meta %}
<meta name="description" content="Fa√ßa login no Sistema Mr. Baruch - CRM moderno e eficiente">
<meta name="theme-color" content="#1E3DFF">
<link rel="manifest" href="{% static 'manifest.json' %}">
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<!-- CSS do sistema -->
<link rel="stylesheet" href="{% static 'css/auth.css' %}">
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

<main class="dashboard-premium py-5">
    <div class="container-fluid px-4">
        <div class="row justify-content-center">
            <div class="col-xl-8 col-lg-9 col-md-11 col-12">
                <div class="card border-0 shadow-lg rounded-4 bg-light-glass overflow-hidden">
                    <div class="row g-0">
                        <!-- Coluna Esquerda: Boas-vindas com gradiente azul-laranja -->
                        <div class="col-md-5 d-flex flex-column justify-content-center align-items-center auth-welcome-panel text-white p-5">
                            <div class="mb-4">
                                <i class="bi bi-shield-check display-1 mb-3"></i>
                            </div>
                            <h2 class="fw-bold mb-3">Bem-vindo de volta!</h2>
                            <p class="mb-4 text-center">Para se manter conectado conosco, fa√ßa login com suas informa√ß√µes pessoais.</p>
                            <p class="small text-center opacity-75">
                                <i class="bi bi-lock-fill me-2"></i>Ambiente seguro e protegido
                            </p>
                        </div>
                        <!-- Coluna Direita: Formul√°rios -->
                        <div class="col-md-7 p-5 auth-form-panel">
                            <div class="d-flex flex-column align-items-center mb-4">
                                <div class="auth-logo mb-3">
                                    <span class="badge bg-gradient-primary-orange fs-3 px-4 py-2 rounded-pill">MB</span>
                                </div>
                                <h2 class="fw-bold mb-1 text-dark text-center">
                                    Sistema Mr. Baruch
                                </h2>
                                <p class="text-muted small mb-0 text-center">Gest√£o completa para seu neg√≥cio</p>
                            </div>
                            <!-- Alert Container -->
                            <div id="alert-container" aria-live="polite"></div>
                            <!-- Loading State -->
                            <div id="loading" class="loading d-none" role="status" aria-label="Processando">
                                <div class="spinner" aria-hidden="true"></div>
                                <p>Processando...</p>
                            </div>
                            <!-- Tabs Navigation -->
                            <nav class="auth-tabs mb-4 d-flex justify-content-center" role="tablist">
                                <button class="auth-tab active rounded-pill px-4 py-2 me-2 shadow-sm fw-semibold" id="login-tab" role="tab" aria-selected="true" aria-controls="login-content">
                                    <i class="bi bi-box-arrow-in-right me-1"></i>Entrar
                                </button>
                                <button class="auth-tab rounded-pill px-4 py-2 shadow-sm fw-semibold" id="register-tab" role="tab" aria-selected="false" aria-controls="register-content">
                                    <i class="bi bi-person-plus me-1"></i>Cadastrar
                                </button>
                            </nav>
                            <div class="tabs-content">
                                <!-- Login Form -->
                                <section id="login-content" class="tab-pane active" role="tabpanel" aria-labelledby="login-tab">
                                    <form id="loginForm" novalidate class="mb-4">
                                        {% csrf_token %}
                                        <div class="mb-3 position-relative">
                                            <label for="login_email" class="form-label fw-semibold">E-mail</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-envelope text-primary"></i></span>
                                                <input type="email" id="login_email" name="email" class="form-control form-control-lg rounded-end-3" placeholder="Digite seu e-mail" required autocomplete="email" aria-required="true">
                                            </div>
                                        </div>
                                        <div class="mb-3 position-relative">
                                            <label for="login_password" class="form-label fw-semibold">Senha</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-lock text-primary"></i></span>
                                                   <input type="password" id="login_password" name="password" class="form-control form-control-lg rounded-end-3" placeholder="Digite sua senha" required autocomplete="current-password" aria-required="true">
                                                   <button type="button" class="btn btn-outline-secondary" id="togglePassword" tabindex="-1" style="border-top-left-radius:0;border-bottom-left-radius:0;">
                                                       <i class="bi bi-eye" id="eyeIcon"></i>
                                                   </button>
                                            </div>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input type="checkbox" id="remember_me" name="remember_me" class="form-check-input">
                                            <label for="remember_me" class="form-check-label">Lembrar de mim por 30 dias</label>
                                        </div>
                                        <button type="submit" class="btn btn-save-solid btn-lg w-100 rounded-pill shadow-sm">Entrar</button>
                                        <div class="mt-3 text-center">
                                            <a href="#" class="forgot-password text-decoration-none small" onclick="alert('Funcionalidade em desenvolvimento. Entre em contato com o administrador.')">
                                                <i class="bi bi-question-circle me-1"></i>Esqueceu sua senha?
                                            </a>
                                        </div>
                                    </form>
                                </section>
                                <!-- Register Form -->
                                <section id="register-content" class="tab-pane inactive" role="tabpanel" aria-labelledby="register-tab">
                                    <form id="registerForm" novalidate>
                                        {% csrf_token %}
                                        <div class="row g-3">
                                            <div class="col-12 col-md-6 position-relative">
                                                <label for="first_name" class="form-label fw-semibold">Nome</label>
                                                <div class="input-group">
                                                    <span class="input-group-text"><i class="bi bi-person text-primary"></i></span>
                                                    <input type="text" id="first_name" name="first_name" class="form-control form-control-lg rounded-end-3" placeholder="Digite seu nome" required autocomplete="given-name" aria-required="true">
                                                </div>
                                            </div>
                                            <div class="col-12 col-md-6 position-relative">
                                                <label for="last_name" class="form-label fw-semibold">Sobrenome</label>
                                                <div class="input-group">
                                                    <span class="input-group-text"><i class="bi bi-person-badge text-primary"></i></span>
                                                    <input type="text" id="last_name" name="last_name" class="form-control form-control-lg rounded-end-3" placeholder="Digite seu sobrenome" required autocomplete="family-name" aria-required="true">
                                                </div>
                                            </div>
                                            <div class="col-12 position-relative">
                                                <label for="register_email" class="form-label fw-semibold">E-mail</label>
                                                <div class="input-group">
                                                    <span class="input-group-text"><i class="bi bi-envelope text-primary"></i></span>
                                                    <input type="email" id="register_email" name="email" class="form-control form-control-lg rounded-end-3" placeholder="Digite seu e-mail" required autocomplete="email" aria-required="true">
                                                </div>
                                            </div>
                                            <div class="col-12 col-md-6 position-relative">
                                                <label for="password1" class="form-label fw-semibold">Senha</label>
                                                <div class="input-group">
                                                    <span class="input-group-text"><i class="bi bi-lock text-primary"></i></span>
                                                    <input type="password" id="password1" name="password1" class="form-control form-control-lg rounded-end-3" placeholder="M√≠nimo 8 caracteres" required autocomplete="new-password" aria-required="true" minlength="8">
                                                </div>
                                            </div>
                                            <div class="col-12 col-md-6 position-relative">
                                                <label for="password2" class="form-label fw-semibold">Confirmar senha</label>
                                                <div class="input-group">
                                                    <span class="input-group-text"><i class="bi bi-lock-fill text-primary"></i></span>
                                                    <input type="password" id="password2" name="password2" class="form-control form-control-lg rounded-end-3" placeholder="Confirme sua senha" required autocomplete="new-password" aria-required="true">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex justify-content-between gap-2 mt-4">
                                            <!--<button type="button" id="saveDraft" class="btn btn-light rounded-pill px-4 shadow-sm">Salvar cadastro</button>-->
                                            <div class="flex-fill"></div>
                                            <button type="submit" class="btn btn-save-solid btn-lg rounded-pill px-4 shadow-sm">Cadastrar-se</button>
                                        </div>
                                    </form>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
                <footer class="text-center mt-4 mb-2 small text-muted">
                    <span>¬© 2025 <strong>Sistema Mr. Baruch</strong> ‚Äî Todos os direitos reservados.</span><br>
                    <a href="#" class="text-decoration-none me-2">Pol√≠tica de Privacidade</a>
                    <a href="#" class="text-decoration-none me-2">Termos de Uso</a>
                    <a href="#" class="text-decoration-none">Suporte</a>
                </footer>
            </div>
        </div>
    </div>
</main>
{% endblock %}
{% block extra_js %}
<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var toggleBtn = document.getElementById('togglePassword');
    var passwordInput = document.getElementById('login_password');
    var eyeIcon = document.getElementById('eyeIcon');
    if (toggleBtn && passwordInput && eyeIcon) {
        toggleBtn.addEventListener('click', function() {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.classList.remove('bi-eye');
                eyeIcon.classList.add('bi-eye-slash');
            } else {
                passwordInput.type = 'password';
                eyeIcon.classList.remove('bi-eye-slash');
                eyeIcon.classList.add('bi-eye');
            }
        });
    }
});
</script>
<script>
    // Fun√ß√µes utilit√°rias de autentica√ß√£o
const AuthUtils = {
    getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return null;
    },

    showAlert(message, type = 'error') {
        const alertContainer = document.getElementById('alert-container');
        const alertId = `alert-${Date.now()}`;
        
        const alertHTML = `
            <div id="${alertId}" class="alert alert-${type} animate-in">
                <div class="alert-content">
                    <span class="alert-icon">${this.getAlertIcon(type)}</span>
                    <span class="alert-message">${message}</span>
                    <button class="alert-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                </div>
            </div>
        `;
        
        alertContainer.insertAdjacentHTML('beforeend', alertHTML);
        
    // Remove automaticamente ap√≥s 5 segundos
        setTimeout(() => {
            const alert = document.getElementById(alertId);
            if (alert) {
                alert.classList.add('animate-out');
                setTimeout(() => alert.remove(), 300);
            }
        }, 5000);
    },

    getAlertIcon(type) {
        const icons = {
            success: '‚úÖ',
            warning: '‚ö†Ô∏è',
            error: '‚ùå'
        };
        return icons[type] || '‚ÑπÔ∏è';
    },

    showLoading(show) {
        const loading = document.getElementById('loading');
        const buttons = document.querySelectorAll('button[type="submit"]');
        
        if (show) {
            loading.classList.remove('d-none');
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.style.opacity = '0.7';
            });
        } else {
            loading.classList.add('d-none');
            buttons.forEach(btn => {
                btn.disabled = false;
                btn.style.opacity = '1';
            });
        }
    },

    saveTokens(data) {
        localStorage.setItem('access_token', data.access_token);
        localStorage.setItem('refresh_token', data.refresh_token);
        localStorage.setItem('user_data', JSON.stringify(data.user));
        
        // Set token expiration (assuming 1 hour)
        const expiresAt = Date.now() + (60 * 60 * 1000);
        localStorage.setItem('token_expires', expiresAt.toString());
    },

    isTokenExpired() {
        const expiresAt = localStorage.getItem('token_expires');
        return !expiresAt || Date.now() > parseInt(expiresAt);
    },

    validateEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    },

    saveRegisterDraft(data) {
        try {
            localStorage.setItem('register_draft', JSON.stringify(data));
        } catch {}
    },

    loadRegisterDraft() {
        try {
            const raw = localStorage.getItem('register_draft');
            return raw ? JSON.parse(raw) : null;
        } catch { return null; }
    },

    validatePassword(password) {
    // M√≠nimo 8 caracteres, pelo menos uma letra e um n√∫mero
        const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d).{8,}$/;
        return passwordRegex.test(password);
    },

    redirectToDashboard() {
        try {
            const user = JSON.parse(localStorage.getItem('user_data') || 'null');
            if (user && Array.isArray(user.groups) && user.groups.includes('atendente')) {
                
                window.location.href = '/atendimento/novo/';
                return;
            }
        } catch (err) {}
        window.location.href = '/accounts/dashboard/';
    }
};

// Gerenciamento das abas de login/cadastro
class TabManager {
    constructor() {
        this.currentTab = 'login';
        this.init();
    }

    init() {
        this.bindEvents();
    }

    switchTab(tabName) {
        if (this.currentTab === tabName) return;
        
        this.currentTab = tabName;
        
    // Atualiza os bot√µes das abas
        document.querySelectorAll('.auth-tab').forEach(btn => {
            btn.classList.remove('active');
            btn.setAttribute('aria-selected', 'false');
        });
        const activeTabBtn = document.getElementById(`${tabName}-tab`);
        activeTabBtn.classList.add('active');
        activeTabBtn.setAttribute('aria-selected', 'true');
        
    // Atualiza o conte√∫do das abas com anima√ß√£o suave
        document.querySelectorAll('.tab-pane').forEach(pane => {
            pane.classList.remove('active');
            pane.classList.add('inactive');
        });
        
        const activePane = document.getElementById(`${tabName}-content`);
        activePane.classList.remove('inactive');
        
    // Pequeno delay para garantir anima√ß√£o suave
        setTimeout(() => {
            activePane.classList.add('active');
        }, 10);
        
    // Atualiza indicador visual da aba
        const tabsContainer = document.querySelector('.auth-tabs');
        tabsContainer.classList.toggle('register-active', tabName === 'register');
        
    // Limpa alertas e erros dos formul√°rios
        this.clearAlerts();
        this.clearFormErrors();
    }

    bindEvents() {
        document.getElementById('login-tab').addEventListener('click', (e) => {
            e.preventDefault();
            this.switchTab('login');
        });
        
        document.getElementById('register-tab').addEventListener('click', (e) => {
            e.preventDefault();
            this.switchTab('register');
        });
    }

    clearAlerts() {
        document.getElementById('alert-container').innerHTML = '';
    }

    clearFormErrors() {
        document.querySelectorAll('.input-error').forEach(error => error.remove());
        document.querySelectorAll('.input-group input').forEach(input => {
            input.classList.remove('error');
        });
    }
}

// üìù Form Handling
class AuthForms {
    constructor() {
        this.tabManager = new TabManager();
        this.init();
    }

    init() {
        this.bindFormEvents();
        this.checkExistingAuth();
        // Load register draft if exists
        const draft = AuthUtils.loadRegisterDraft();
        if (draft) {
            try {
                const map = ['first_name','last_name','email','password1','password2'];
                map.forEach(k => {
                    const el = document.getElementById(k === 'email' ? 'register_email' : k);
                    if (el && draft[k] !== undefined) el.value = draft[k];
                });
                AuthUtils.showAlert('Rascunho de cadastro carregado.', 'success');
            } catch {}
        }
    }

    bindFormEvents() {
    // Formul√°rio de login
        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            this.handleLogin();
        });

    // Formul√°rio de cadastro
        document.getElementById('registerForm').addEventListener('submit', (e) => {
            e.preventDefault();
            this.handleRegister();
        });

    // Bot√£o para salvar rascunho do cadastro
        const saveBtn = document.getElementById('saveDraft');
        if (saveBtn) {
            saveBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const data = Object.fromEntries(new FormData(document.getElementById('registerForm')));
                AuthUtils.saveRegisterDraft(data);
                AuthUtils.showAlert('Rascunho salvo com sucesso.', 'success');
            });
        }

    // Valida√ß√£o em tempo real
        this.bindRealTimeValidation();
    }

    async handleLogin() {
        const formData = new FormData(document.getElementById('loginForm'));
        const data = Object.fromEntries(formData);
        
    // Valida√ß√£o dos campos
        if (!this.validateLoginData(data)) return;
        
        AuthUtils.showLoading(true);
        
        try {
            const response = await fetch('/accounts/api/auth/login/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': AuthUtils.getCookie('csrftoken')
                },
                body: JSON.stringify({
                    ...data,
                    remember_me: document.getElementById('remember_me').checked
                })
            });

            const result = await response.json();

            if (response.ok && result.access_token) {
                AuthUtils.saveTokens(result);
                AuthUtils.showAlert('Login realizado com sucesso!', 'success');
                setTimeout(AuthUtils.redirectToDashboard, 1500);
            } else {
                AuthUtils.showAlert(result.error || 'Erro no login. Verifique suas credenciais.');
            }
        } catch (error) {
            console.error('Login error:', error);
            AuthUtils.showAlert('Erro de conex√£o. Tente novamente.');
        } finally {
            AuthUtils.showLoading(false);
        }
    }

    async handleRegister() {
        const formData = new FormData(document.getElementById('registerForm'));
        const data = Object.fromEntries(formData);
        
        // Validation
        if (!this.validateRegisterData(data)) return;
        
        AuthUtils.showLoading(true);
        
        try {
            const response = await fetch('/accounts/api/auth/register/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': AuthUtils.getCookie('csrftoken')
                },
                body: JSON.stringify(data)
            });

            const result = await response.json();

            if (response.ok && result.access_token) {
                AuthUtils.saveTokens(result);
                AuthUtils.showAlert('Conta criada com sucesso!', 'success');
                setTimeout(AuthUtils.redirectToDashboard, 2000);
            } else if (result.errors) {
                this.displayFormErrors(result.errors);
            } else {
                AuthUtils.showAlert(result.detail || 'Erro no cadastro.');
            }
        } catch (error) {
            console.error('Registration error:', error);
            AuthUtils.showAlert('Erro de conex√£o. Tente novamente.');
        } finally {
            AuthUtils.showLoading(false);
        }
    }

    validateLoginData(data) {
        if (!AuthUtils.validateEmail(data.email)) {
            AuthUtils.showAlert('Por favor, insira um e-mail v√°lido.');
            return false;
        }
        
        if (!data.password) {
            AuthUtils.showAlert('Por favor, insira sua senha.');
            return false;
        }
        
        return true;
    }

    validateRegisterData(data) {
    // Valida√ß√£o do nome
        if (!data.first_name || data.first_name.length < 2) {
            AuthUtils.showAlert('Por favor, insira um nome v√°lido (m√≠nimo 2 caracteres).');
            return false;
        }

        if (!data.last_name || data.last_name.length < 2) {
            AuthUtils.showAlert('Por favor, insira um sobrenome v√°lido.');
            return false;
        }

    // Valida√ß√£o do e-mail
        if (!AuthUtils.validateEmail(data.email)) {
            AuthUtils.showAlert('Por favor, insira um e-mail v√°lido.');
            return false;
        }

    // Valida√ß√£o da senha
        if (!AuthUtils.validatePassword(data.password1)) {
            AuthUtils.showAlert('A senha deve ter pelo menos 8 caracteres, incluindo letras e n√∫meros.');
            return false;
        }

        if (data.password1 !== data.password2) {
            AuthUtils.showAlert('As senhas n√£o coincidem.');
            return false;
        }

        return true;
    }

    displayFormErrors(errors) {
        for (const [field, messages] of Object.entries(errors)) {
            const input = document.querySelector(`[name="${field}"]`);
            if (input) {
                input.classList.add('error');
                const errorElement = document.createElement('div');
                errorElement.className = 'input-error';
                errorElement.textContent = Array.isArray(messages) ? messages.join(', ') : messages;
                input.parentNode.appendChild(errorElement);
            }
        }
    }

    bindRealTimeValidation() {
    // Valida√ß√£o de e-mail em tempo real
        document.getElementById('register_email').addEventListener('blur', (e) => {
            if (e.target.value && !AuthUtils.validateEmail(e.target.value)) {
                this.showFieldError(e.target, 'E-mail inv√°lido');
            } else {
                this.clearFieldError(e.target);
            }
        });

    // Valida√ß√£o de confirma√ß√£o de senha em tempo real
        document.getElementById('password2').addEventListener('blur', (e) => {
            const password1 = document.getElementById('password1').value;
            const password2 = e.target.value;
            
            if (password2 && password1 !== password2) {
                this.showFieldError(e.target, 'As senhas n√£o coincidem');
            } else {
                this.clearFieldError(e.target);
            }
        });
    }

    showFieldError(input, message) {
        this.clearFieldError(input);
        input.classList.add('error');
        const errorElement = document.createElement('div');
        errorElement.className = 'input-error';
        errorElement.textContent = message;
        input.parentNode.appendChild(errorElement);
    }

    clearFieldError(input) {
        input.classList.remove('error');
        const existingError = input.parentNode.querySelector('.input-error');
        if (existingError) {
            existingError.remove();
        }
    }

    async checkExistingAuth() {
        const token = localStorage.getItem('access_token');
        
        if (token && !AuthUtils.isTokenExpired()) {
            try {
                const response = await fetch('/accounts/api/profile/', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    AuthUtils.redirectToDashboard();
                } else {
                // Token inv√°lido, limpa do localStorage
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('refresh_token');
                    localStorage.removeItem('token_expires');
                }
            } catch (error) {
                console.error('Token validation error:', error);
                localStorage.removeItem('access_token');
                localStorage.removeItem('refresh_token');
                localStorage.removeItem('token_expires');
            }
        }
    }
}

// Inicializa√ß√£o do JS de autentica√ß√£o
document.addEventListener('DOMContentLoaded', function() {
    new AuthForms();
});
</script>
</script>
<style>
/* === TEMA AZUL-LARANJA DO SISTEMA MR. BARUCH === */

/* Gradiente principal azul-laranja para a coluna de boas-vindas */
.auth-welcome-panel {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 50%, #f97316 100%);
    box-shadow: inset 0 0 100px rgba(0,0,0,0.1);
    position: relative;
}

.auth-welcome-panel::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>');
    opacity: 0.3;
}

.auth-welcome-panel h2,
.auth-welcome-panel p,
.auth-welcome-panel i {
    position: relative;
    z-index: 1;
}

/* Badge gradiente para o logo */
.bg-gradient-primary-orange {
    background: linear-gradient(135deg, #2563eb 0%, #f97316 100%);
    color: #fff;
    font-weight: 700;
    box-shadow: 0 4px 12px rgba(37,99,235,0.3);
}

/* Fundo glass e card premium */
.dashboard-premium {
    background: linear-gradient(180deg, #f0f4ff 0%, #fff5ed 100%);
    min-height: 100vh;
}

.bg-light-glass {
    background: rgba(255,255,255,0.95);
    backdrop-filter: blur(12px);
}

/* Bot√µes do sistema com tema azul-laranja */
.btn-save-solid {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    color: #fff;
    border: none;
    transition: all .3s ease;
    box-shadow: 0 4px 12px rgba(37,99,235,0.25);
}

.btn-save-solid:hover, .btn-save-solid:focus {
    background: linear-gradient(135deg, #1d4ed8 0%, #f97316 100%);
    color: #fff;
    box-shadow: 0 6px 18px rgba(249,115,22,0.35);
    transform: translateY(-2px);
}

/* Abas de navega√ß√£o com tema */
.auth-tab {
    background: transparent;
    border: 2px solid #e5e7eb;
    color: #6b7280;
    transition: all .3s ease;
}

.auth-tab:hover {
    border-color: #2563eb;
    color: #2563eb;
}

.auth-tab.active {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    border-color: #2563eb;
    color: #fff;
    box-shadow: 0 4px 12px rgba(37,99,235,0.25);
}

/* Inputs elegantes com destaque laranja no foco */
.form-control-lg {
    font-size: 1.05rem;
    padding: 0.85rem 1rem;
    border: 2px solid #e5e7eb;
    background-color: #fff;
    color: #1f2937;
    transition: all .3s ease;
}

.form-control-lg:focus {
    border-color: #f97316;
    background-color: #fff;
    box-shadow: 0 0 0 0.2rem rgba(249,115,22,0.15);
    outline: none;
}

.form-control-lg::placeholder {
    color: #9ca3af;
    opacity: 1;
}

.input-group-text {
    background: #f0f4ff;
    border: 2px solid #e5e7eb;
    border-right: 2px solid #e5e7eb;
    border-radius: 1rem 0 0 1rem;
}

.form-control.rounded-end-3 {
    border-radius: 0 1rem 1rem 0;
    border-left: 2px solid #e5e7eb;
}

.input-group .form-control {
    border-left: 2px solid #e5e7eb;
}

.input-group .form-control:focus {
    border-left-color: #f97316;
}

.input-group:focus-within .input-group-text {
    border-color: #f97316;
    background: #fff5ed;
}

/* Bot√£o outline light na coluna azul */
.btn-outline-light {
    border: 2px solid rgba(255,255,255,0.8);
    backdrop-filter: blur(10px);
    transition: all .3s ease;
}

.btn-outline-light:hover {
    background: rgba(255,255,255,0.2);
    border-color: #fff;
    transform: scale(1.05);
}

/* Alert premium com tema */
.alert {
    border-radius: 1rem;
    border: none;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.alert-success {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: #fff;
}

.alert-error {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    color: #fff;
}

/* Loading spinner elegante */
.loading {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(8px);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #e5e7eb;
    border-top-color: #2563eb;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Tab pane transitions */
.tab-pane {
    opacity: 1;
    transition: opacity .3s ease;
}

.tab-pane.inactive {
    display: none;
    opacity: 0;
}

/* Responsividade para telas pequenas (celular) */
@media (max-width: 767.98px) {
    .auth-welcome-panel {
        display: none !important;
    }
    
    .auth-form-panel {
        padding: 2rem 1.5rem !important;
    }
    
    .card-body {
        padding: 1.5rem !important;
    }
    
    .auth-logo .badge {
        font-size: 1.5rem !important;
    }
    
    h2 {
        font-size: 1.5rem;
    }
    
    .auth-tab {
        font-size: 0.9rem;
        padding: 0.5rem 1.2rem !important;
    }
}

@media (max-width: 575.98px) {
    .container-fluid {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
    }
    
    .auth-form-panel {
        padding: 1.5rem 1rem !important;
    }
    
    .auth-tab {
        font-size: 0.85rem;
        padding: 0.5rem 1rem !important;
        margin: 0 0.25rem !important;
    }
    
    .form-control-lg {
        font-size: 1rem;
        padding: 0.7rem 0.9rem;
    }
    
    .btn-save-solid, .btn-light {
        font-size: 1rem;
        padding: 0.75rem 1.3rem;
    }
    
    .rounded-4 {
        border-radius: 1rem !important;
    }
    
    .col-12 .col-md-6 {
        margin-bottom: 0.5rem;
    }
    
    footer {
        font-size: 0.75rem;
        padding: 0 0.5rem;
    }
    
    footer br {
        display: none;
    }
    
    footer a {
        display: block;
        margin: 0.25rem 0;
    }
}

/* Mobile enhancements: make controls larger and easier to tap */
@media (max-width: 767.98px) {
    .auth-logo .badge {
        font-size: 1.8rem !important;
        padding: 0.65rem 1rem !important;
    }

    .auth-form-panel h2 {
        font-size: 1.4rem !important;
    }

    .input-group {
        border-width: 2px !important;
    }

    .input-group .input-group-text {
        padding: 0.85rem 1rem !important;
        font-size: 1.05rem !important;
    }

    .input-group .form-control {
        padding: 0.9rem 1rem !important;
        font-size: 1.03rem !important;
    }

    .auth-tab {
        font-size: 1rem !important;
        padding: 0.6rem 1.2rem !important;
    }

    .btn-save-solid, .btn-light {
        padding: 0.9rem 1.2rem !important;
        font-size: 1.02rem !important;
        border-radius: 1rem !important;
    }

    .tabs-content {
        margin-top: 0.75rem !important;
    }

    .card {
        border-radius: 1rem !important;
    }
}

.input-group {
    border: 2px solid #e5e7eb !important;
    border-radius: 1rem !important;
    overflow: hidden !important;
}

.input-group .input-group-text,
.input-group .form-control {
    border: none !important;
    box-shadow: none !important;
    background: transparent !important;
}

.input-group .input-group-text {
    background: #f0f4ff !important;
    color: #2563eb !important;
    padding: 0.65rem 0.85rem !important;
}

.input-group .form-control {
    background: #ffffff !important;
    color: #1f2937 !important;
    padding: 0.7rem 1rem !important;
}

.input-group:focus-within {
    border-color: #f97316 !important;
    box-shadow: 0 0 0 0.15rem rgba(249,115,22,0.10) !important;
}

.input-group .form-control::placeholder {
    color: #9ca3af !important;
    opacity: 1 !important;
}

</style>
{% endblock %}